<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Track MyCash Pro</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Poppins:100,300,400,500,600,700" rel="stylesheet" />
  
  <style>
    /* --- VARIABLES --- */
    :root {
      --primary: #008000;
      --secondary: #ff8c00;
      --bg: #f4f7f6;
      --card-bg: #ffffff;
      --text: #333;
      --border: #e0e0e0;
      --shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    /* --- RESET & GLOBAL --- */
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: var(--bg);
      color: var(--text);
      padding-bottom: 80px; /* Space for footer/buttons */
      transition: 0.3s;
    }

    .container {
      max-width: 1100px; /* Wider for Row Layout */
      margin: 0 auto;
      padding: 15px;
    }

    /* --- LOGO --- */
    .logo-desi { text-align: center; margin-bottom: 20px; }
    .logo-desi span { font-size: 28px; font-weight: 700; }
    .orange { color: var(--secondary); }
    .green { color: var(--primary); }

    /* --- LAYOUT GRID (The Row Format Logic) --- */
    .dashboard-grid {
      display: grid;
      grid-template-columns: 1fr 1fr; /* Two Equal Columns */
      gap: 25px;
      align-items: start;
    }

    /* --- LEFT PANEL (Stats) --- */
    .left-panel { display: flex; flex-direction: column; gap: 20px; }

    /* Balance Card */
    .balance-card {
      background: var(--card-bg);
      padding: 25px;
      border-radius: 15px;
      box-shadow: var(--shadow);
      text-align: center;
    }
    .balance-card h1 { font-size: 40px; color: var(--primary); margin: 5px 0; }
    
    .summary-row {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid var(--border);
    }
    .income p { color: #2ecc71; font-weight: bold; font-size: 18px; margin: 0; }
    .expense p { color: #e74c3c; font-weight: bold; font-size: 18px; margin: 0; }

    /* Limit Box */
    .limit-box {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 15px;
      border: 1px dashed var(--primary);
      box-shadow: var(--shadow);
    }
    .progress-track { height: 8px; background: #eee; border-radius: 4px; overflow: hidden; margin: 10px 0; }
    .progress-fill { height: 100%; width: 0%; background: var(--primary); transition: width 0.5s; }
    .limit-inputs { display: flex; gap: 5px; margin-top: 10px; }
    .limit-inputs input { flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 5px; }

    /* Chart Box */
    .chart-box {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 15px;
      box-shadow: var(--shadow);
      height: 300px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* --- RIGHT PANEL (Form & List) --- */
    .right-panel { display: flex; flex-direction: column; gap: 20px; }

    /* Form */
    .form-card {
      background: var(--card-bg);
      padding: 25px;
      border-radius: 15px;
      box-shadow: var(--shadow);
    }
    .form-group { margin-bottom: 12px; }
    .form-group label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 5px; color: #666; }
    input, select {
      width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-family: inherit;
    }
    
    .btn-main {
      width: 100%; background: var(--primary); color: white; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; transition: 0.2s;
    }
    .btn-main:hover { background: #006400; }
    
    .action-buttons { display: flex; gap: 10px; margin-top: 10px; }
    .btn-sm { flex: 1; padding: 10px; border: none; border-radius: 8px; cursor: pointer; color: white; font-size: 13px; }

    /* Transaction List */
    .history-card {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 15px;
      box-shadow: var(--shadow);
    }
    .scroll-area {
        max-height: 400px; /* Keeps list from getting too long */
        overflow-y: auto;
        padding-right: 5px;
    }
    .transaction-item {
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px; border-bottom: 1px solid #eee; font-size: 14px;
    }
    .transaction-item:last-child { border-bottom: none; }
    .border-l-green { border-left: 4px solid #2ecc71; }
    .border-l-red { border-left: 4px solid #e74c3c; }
    .delete-icon { cursor: pointer; color: #ccc; margin-left: 10px; transition: 0.2s; }
    .delete-icon:hover { color: #e74c3c; }

    /* --- MOBILE RESPONSIVE --- */
    @media (max-width: 768px) {
      .dashboard-grid {
        grid-template-columns: 1fr; /* Switch to Single Column */
      }
      .container { padding: 10px; }
      .chart-box { height: 250px; }
    }

    /* --- DARK MODE --- */
    body.dark-mode { --bg: #121212; --card-bg: #1e1e1e; --text: #f1f1f1; --border: #333; }
    body.dark-mode input, body.dark-mode select { background: #2c2c2c; color: white; border-color: #444; }

    /* Floating */
    #darkModeToggle, #chatToggle {
      position: fixed; right: 20px; width: 50px; height: 50px; border-radius: 50%; border: none; color: white; font-size: 20px; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.3); z-index: 999;
    }
    #darkModeToggle { bottom: 20px; background: linear-gradient(135deg, #444, #222); }
    #chatToggle { bottom: 80px; background: var(--primary); }

    /* Simple Chat */
    #supportChat {
        position: fixed; bottom: 140px; right: 20px; width: 300px; background: white; border-radius: 12px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); display: none; overflow: hidden; z-index: 1000;
    }
    .chat-inner { padding: 15px; height: 200px; overflow-y: auto; background: #f9f9f9; display: flex; flex-direction: column; gap: 8px; }
    .msg { padding: 8px; border-radius: 8px; font-size: 13px; max-width: 80%; }
    .bot { background: #eee; align-self: flex-start; color: black; }
    .user { background: #d1ffd6; align-self: flex-end; color: black; }
  </style>
</head>
<body>

<div class="container">
  
  <div class="logo-desi">
    <span class="orange">Track</span><span class="green">MyCash</span>
    <div style="font-size: 12px; color: #777;">Pro Dashboard</div>
  </div>

  <div class="dashboard-grid">
    
    <div class="left-panel">
      
      <div class="balance-card">
        <h3>Current Balance</h3>
        <h1 id="balance">‚Çπ0.00</h1>
        <div class="summary-row">
          <div class="income">
            <small>INCOME</small>
            <p id="income-amount">‚Çπ0.00</p>
          </div>
          <div class="expense">
            <small>EXPENSE</small>
            <p id="expense-amount">‚Çπ0.00</p>
          </div>
        </div>
      </div>

      <div class="limit-box">
        <div style="display:flex; justify-content:space-between;">
            <strong>üìÖ Monthly Limit</strong>
            <span id="limitText">‚Çπ0</span>
        </div>
        <div class="progress-track">
            <div class="progress-fill" id="limitBar"></div>
        </div>
        <small id="limitWarning" style="color:red; display:none;">‚ö†Ô∏è Limit Exceeded!</small>
        <div class="limit-inputs">
            <input type="number" id="monthlyLimitInput" placeholder="Set Amount...">
            <button onclick="updateLimit()" style="background:var(--primary); color:white; border:none; padding:0 15px; border-radius:5px; cursor:pointer;">Set</button>
        </div>
      </div>

      <div class="chart-box">
        <h4 style="margin:0 0 10px 0;">Spending Breakdown</h4>
        <div style="position: relative; height: 100%; width: 100%;">
            <canvas id="expenseChart"></canvas>
        </div>
      </div>

    </div>

    <div class="right-panel">
      
      <div class="form-card">
        <h3 style="margin-top:0;">Add Transaction</h3>
        <form id="transaction-form">
          <div class="form-group">
            <label>Category</label>
           <select id="description" required>
    <option value="">-- Select an item --</option>
    <option value="Groceries">üõí Groceries</option>
    <option value="Travel">üöå Travel</option>
    <option value="Food">üçî Food</option>
    <option value="Electricity Bill">üí° Electricity Bill</option>
    <option value="Water Bill">üö∞ Water Bill</option>
    <option value="Gas">‚õΩ Gas</option>
    <option value="Medicine">üíä Medicine</option>
    <option value="Shopping">üõç Shopping</option>
    <option value="Entertainment">üé¨ Entertainment</option>
    <option value="Salary">üíº Salary</option>
    <option value="Bonus">üí∞ Bonus</option>
    <option value="Others">üì¶ Others</option>
  </select>
          </div>
          <div class="dashboard-grid" style="grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 0;">
             <div class="form-group">
                <label>Date</label>
                <input type="date" id="date" required />
             </div>
             <div class="form-group">
                <label>Amount (‚Çπ)</label>
                <input type="number" id="amount" placeholder="100" required />
             </div>
          </div>
          
          <button type="submit" class="btn-main">Add Transaction</button>
          
          <div class="action-buttons">
            <button type="button" onclick="downloadPDF()" class="btn-sm" style="background:#555;">üìÑ Download PDF</button>
            <button type="button" onclick="resetData()" class="btn-sm" style="background:#c0392b;">üóë Reset All</button>
          </div>
        </form>
      </div>

      <div class="history-card">
        <h3 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">History</h3>
        <div class="scroll-area">
            <ul id="transaction-list" style="list-style: none; padding: 0;">
                </ul>
        </div>
      </div>

    </div>

  </div>

  <footer style="text-align:center; margin-top: 30px; font-size: 12px; color: #777;">
    @2025 Track MyCash. All Right Reserved 
  </footer>

</div>

<button id="darkModeToggle">üåô</button>
<div id="chatToggle">üí¨</div>

<div id="supportChat">
  <div style="background:var(--primary); color:white; padding:10px; font-weight:bold;">Track Mycash Assistant</div>
  <div id="chatBody" class="chat-inner">
      <div class="msg bot">Namaste üôè! Main aapka Track MyCash Support AI hoon. Aapko kis mein madad chahiye?.</div>
  </div>
  <div style="display:flex; padding:5px; border-top:1px solid #ccc;">
      <input id="chatInput" style="border:none;" placeholder="Type here...">
      <button id="sendBtn" style="background:var(--primary); color:white; border:none; padding:5px 10px;">‚û§</button>
  </div>
</div>

<script>
    // --- JS LOGIC ---
    
    // Elements
    const balanceEl = document.getElementById('balance');
    const incomeEl = document.getElementById('income-amount');
    const expenseEl = document.getElementById('expense-amount');
    const listEl = document.getElementById('transaction-list');
    const limitBar = document.getElementById('limitBar');
    const limitText = document.getElementById('limitText');
    const limitWarning = document.getElementById('limitWarning');

    // State
    let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
    let monthlyLimit = localStorage.getItem('monthlyLimit') || 0;
    let myChart = null;

    // Formatter
    const formatMoney = (num) => "‚Çπ" + parseFloat(num).toLocaleString('en-IN');

    // Core Update
    function updateValues() {
        const amounts = transactions.map(t => t.amount);
        const total = amounts.reduce((acc, item) => (acc += item), 0);
        const income = amounts.filter(item => item > 0).reduce((acc, item) => (acc += item), 0);
        const expense = (amounts.filter(item => item < 0).reduce((acc, item) => (acc += item), 0) * -1);

        balanceEl.innerText = formatMoney(total);
        incomeEl.innerText = formatMoney(income);
        expenseEl.innerText = formatMoney(expense);

        updateLimitUI(expense);
        renderChart();
    }

    // Limit Logic
    function updateLimitUI(currentExpense) {
        limitText.innerText = formatMoney(monthlyLimit);
        if(monthlyLimit > 0) {
            const pct = Math.min((currentExpense / monthlyLimit) * 100, 100);
            limitBar.style.width = `${pct}%`;
            limitBar.style.background = pct > 90 ? '#e74c3c' : (pct > 70 ? '#f1c40f' : '#2ecc71');
            limitWarning.style.display = currentExpense > monthlyLimit ? 'block' : 'none';
        } else {
            limitBar.style.width = '0%';
        }
    }

    function updateLimit() {
        const val = document.getElementById('monthlyLimitInput').value;
        if(val) {
            monthlyLimit = val;
            localStorage.setItem('monthlyLimit', val);
            updateValues();
        }
    }

    // Add to DOM
    function addTransactionDOM(t) {
        const sign = t.amount < 0 ? '-' : '+';
        const li = document.createElement('li');
        li.className = `transaction-item ${t.amount < 0 ? 'border-l-red' : 'border-l-green'}`;
        li.innerHTML = `
            <div>
                <strong>${t.desc}</strong><br>
                <small style="color:#777">${t.date}</small>
            </div>
            <div style="display:flex; align-items:center;">
                <span style="font-weight:600; color:${t.amount < 0 ? '#e74c3c' : '#2ecc71'}">
                    ${sign}${formatMoney(Math.abs(t.amount)).replace('‚Çπ','')}
                </span>
                <span class="delete-icon" onclick="removeTrans(${t.id})">‚úñ</span>
            </div>
        `;
        listEl.prepend(li); // Add new items to top
    }

    // Handlers
    function removeTrans(id) {
        transactions = transactions.filter(t => t.id !== id);
        localStorage.setItem('transactions', JSON.stringify(transactions));
        init();
    }

    function resetData() {
        if(confirm("Delete All Data?")) {
            localStorage.clear();
            location.reload();
        }
    }

    document.getElementById('transaction-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const desc = document.getElementById('description').value;
        const date = document.getElementById('date').value;
        const amount = +document.getElementById('amount').value;
        const isIncome = ['Salary','Bonus'].includes(desc); 
        const finalAmount = isIncome ? amount : -Math.abs(amount); // Auto-negative for expenses

        const t = { id: Date.now(), desc, date, amount: finalAmount };
        transactions.push(t);
        localStorage.setItem('transactions', JSON.stringify(transactions));
        addTransactionDOM(t);
        updateValues();
        e.target.reset();
    });

    // Chart
    function renderChart() {
        const ctx = document.getElementById('expenseChart').getContext('2d');
        const categories = {};
        transactions.forEach(t => {
            if(t.amount < 0) {
                categories[t.desc] = (categories[t.desc] || 0) + Math.abs(t.amount);
            }
        });
        
        if(myChart) myChart.destroy();
        myChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: Object.keys(categories),
                datasets: [{ data: Object.values(categories), backgroundColor: ['#FF6384','#36A2EB','#FFCE56','#4BC0C0','#9966FF'] }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });
    }

    // Extras
    function downloadPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.text("Statement", 10, 10);
        let y = 20;
        transactions.forEach(t => { doc.text(`${t.date}: ${t.desc} - ${t.amount}`, 10, y); y+=10; });
        doc.save('statement.pdf');
    }

    // Init
    function init() {
        listEl.innerHTML = '';
        transactions.forEach(addTransactionDOM);
        updateValues();
    }
    init();

    // Dark Mode & Chat Toggles
    const body = document.body;
    const dmBtn = document.getElementById('darkModeToggle');
    if(localStorage.getItem('theme')==='dark') { body.classList.add('dark-mode'); dmBtn.innerText='‚òÄÔ∏è'; }
    
    dmBtn.addEventListener('click', () => {
        body.classList.toggle('dark-mode');
        const isDark = body.classList.contains('dark-mode');
        localStorage.setItem('theme', isDark?'dark':'light');
        dmBtn.innerText = isDark?'‚òÄÔ∏è':'üåô';
    });

    const chatEl = document.getElementById('supportChat');
    document.getElementById('chatToggle').addEventListener('click', () => {
        chatEl.style.display = chatEl.style.display==='none'?'block':'none';
    });
    document.getElementById('sendBtn').addEventListener('click', () => {
        const inp = document.getElementById('chatInput');
        if(inp.value) {
            document.getElementById('chatBody').innerHTML += `<div class="msg user">${inp.value}</div>`;
            inp.value = '';
        }
    });

</script>
</body>
</html>